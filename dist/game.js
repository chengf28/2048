!function(g){var I={};function C(A){if(I[A])return I[A].exports;var r=I[A]={i:A,l:!1,exports:{}};return g[A].call(r.exports,r,r.exports,C),r.l=!0,r.exports}C.m=g,C.c=I,C.d=function(g,I,A){C.o(g,I)||Object.defineProperty(g,I,{enumerable:!0,get:A})},C.r=function(g){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},C.t=function(g,I){if(1&I&&(g=C(g)),8&I)return g;if(4&I&&"object"==typeof g&&g&&g.__esModule)return g;var A=Object.create(null);if(C.r(A),Object.defineProperty(A,"default",{enumerable:!0,value:g}),2&I&&"string"!=typeof g)for(var r in g)C.d(A,r,function(I){return g[I]}.bind(null,r));return A},C.n=function(g){var I=g&&g.__esModule?function(){return g.default}:function(){return g};return C.d(I,"a",I),I},C.o=function(g,I){return Object.prototype.hasOwnProperty.call(g,I)},C.p="",C(C.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./src/gameController.js\nclass gameController\r\n{\r\n    /**\r\n     * 构造函数\r\n     * @param {int} num 大小\r\n     */\r\n    constructor(num)\r\n    {\r\n        this.num    = num;\r\n        this.border = this.init(num);\r\n        // this.border = border;\r\n        // this.width  = width;\r\n    }\r\n    /**\r\n     * 初始化数据矩阵(二维数组)\r\n     * @param {int} num 初始化\r\n     */\r\n    init(num)\r\n    {\r\n        let border = [];\r\n        for (let i = 0; i < num; i++)\r\n        {\r\n            border[i]  = [];\r\n            for(let j = 0 ; j <num ; j++)\r\n            {\r\n                border[i][j]  = 0;\r\n            }\r\n        }\r\n        return border;\r\n    }\r\n\r\n    /**\r\n     * 随机生成times个数字\r\n     * @param inst times 生成个数\r\n     */\r\n    createNum(times)\r\n    {\r\n        // 检查是否还有空余的格子\r\n        for (let i = 0; i < times; i++) \r\n        {\r\n            if (!this.checkSpace()) \r\n            {\r\n                // let randY = 0;\r\n                while (true) {\r\n                    // 随机x位置\r\n                    let randX = parseInt(Math.floor(Math.random() * this.num));\r\n                    // let randX = 0;\r\n                    // 随机y位置\r\n                    let randY = parseInt(Math.floor(Math.random() * this.num));\r\n                    // 设置随机值\r\n                    if (this.border[randX][randY] == 0) {\r\n                        this.border[randX][randY] = Math.random() < .5 ? 2 : 4;\r\n                        break;\r\n                    }\r\n                    // randY = 2;\r\n                }\r\n            } else {\r\n                var r = confirm(\"游戏结束\")\r\n                if (r == true) {\r\n                    window.location.href = location.href;   \r\n                }\r\n                else {\r\n                    window.location.href = location.href;   \r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 检查是否还有空余空间\r\n     */\r\n    checkSpace()\r\n    {\r\n        return this.border.every(function (iarr, i) {\r\n            return iarr.every(function (num, j) {\r\n                if (num == 0) {\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    \r\n    Down()\r\n    {\r\n        let Matrix = this.border;\r\n        for (let i = 0; i < Matrix.length; i++) {\r\n            // 从上向下遍历(排除第一位)\r\n            for (let j = Matrix[i].length - 1; j >= 0; j--) {\r\n                for (let k = j - 1; k >= 0; k--) {\r\n                    if (Matrix[i][k] == 0) {\r\n                        continue;\r\n                    }\r\n                    if (Matrix[i][k] != Matrix[i][j]) {\r\n                        if (Matrix[i][j] == 0) {\r\n                            for (let n = k - 1; n >= -1; n--) {\r\n                                // 到达边界\r\n                                if (!Matrix[i].hasOwnProperty(n)) {\r\n                                    Matrix[i][j] = Matrix[i][k];\r\n                                    Matrix[i][k] = 0;\r\n                                    break;\r\n                                }\r\n                                if (Matrix[i][n] == 0) {\r\n                                    continue;\r\n                                }\r\n                                if (Matrix[i][n] == Matrix[i][k]) {\r\n                                    Matrix[i][j] = Matrix[i][n] * 2;\r\n                                    Matrix[i][k] = 0;\r\n                                    Matrix[i][n] = 0;\r\n                                    break;\r\n                                }\r\n                                if (Matrix[i].hasOwnProperty(n) && Matrix[i][n] != Matrix[i][k] && Matrix[i][j] == 0) {\r\n                                    Matrix[i][j] = Matrix[i][k];\r\n                                    Matrix[i][k] = 0;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        break;\r\n                    }\r\n                    if (Matrix[i][k] == Matrix[i][j]) {\r\n                        Matrix[i][j] += Matrix[i][k];\r\n                        Matrix[i][k] = 0;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.border = Matrix;\r\n    }\r\n\r\n\r\n    Up()\r\n    {\r\n        let Matrix = this.border;\r\n        for (let i = 0; i < Matrix.length; i++) \r\n        {\r\n            // 从上向下遍历\r\n            for (let j = 0; j < Matrix[i].length; j++) {\r\n                for (let k = j + 1; k < Matrix[i].length; k++) {\r\n\r\n                    if (Matrix[i][k] == 0) {\r\n                        continue;\r\n                    }\r\n                    if (Matrix[i][k] != Matrix[i][j]) {\r\n\r\n                        if (Matrix[i][j] == 0) {\r\n                            for (let n = k + 1; n <= Matrix[i].length; n++) {\r\n                                // 到达边界\r\n                                if (!Matrix[i].hasOwnProperty(n)) {\r\n                                    Matrix[i][j] = Matrix[i][k];\r\n                                    Matrix[i][k] = 0;\r\n                                    break;\r\n                                }\r\n                                if (Matrix[i][n] == 0) {\r\n                                    continue;\r\n                                }\r\n                                if (Matrix[i][n] == Matrix[i][k]) {\r\n                                    Matrix[i][j] = Matrix[i][n] * 2;\r\n                                    Matrix[i][k] = 0;\r\n                                    Matrix[i][n] = 0;\r\n                                    break;\r\n                                }\r\n                                if (Matrix[i].hasOwnProperty(n) && Matrix[i][n] != Matrix[i][k]) {\r\n                                    Matrix[i][j] = Matrix[i][k];\r\n                                    Matrix[i][k] = 0;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    if (Matrix[i][j] == Matrix[i][k]) {\r\n                        Matrix[i][j] += Matrix[i][k];\r\n                        Matrix[i][k] = 0;\r\n                        break;\r\n                    }\r\n\r\n                }\r\n            }\r\n        }\r\n        this.border = Matrix;\r\n    }\r\n\r\n    Left()\r\n    {\r\n        let Matrix = this.border;\r\n        for (let i = 0; i < Matrix.length; i++) {\r\n            // 从上向下遍历\r\n            for (let j = 0; j < Matrix[i].length; j++) {\r\n                for (let k = i + 1; k < Matrix.length; k++) {\r\n                    if (Matrix[k][j] == 0) {\r\n                        continue;\r\n                    }\r\n                    if (Matrix[k][j] != Matrix[i][j]) {\r\n                        if (Matrix[i][j] == 0) {\r\n                            for (let n = k + 1; n <= Matrix.length; n++) {\r\n                                // 到达边界\r\n                                if (!Matrix.hasOwnProperty(n)) {\r\n                                    Matrix[i][j] = Matrix[k][j];\r\n                                    Matrix[k][j] = 0;\r\n                                    break;\r\n                                }\r\n                                if (Matrix[n][i] == 0) {\r\n                                    continue;\r\n                                }\r\n                                if (Matrix[n][j] == Matrix[k][j]) {\r\n                                    Matrix[i][j] = Matrix[n][j] * 2;\r\n                                    Matrix[k][j] = 0;\r\n                                    Matrix[n][j] = 0;\r\n                                    break;\r\n                                }\r\n                                if (Matrix.hasOwnProperty(n) && Matrix[n][j] != Matrix[k][j]) {\r\n                                    Matrix[i][j] = Matrix[k][j];\r\n                                    Matrix[k][j] = 0;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    if (Matrix[i][j] == Matrix[k][j]) {\r\n                        Matrix[i][j] += Matrix[k][j];\r\n                        Matrix[k][j] = 0;\r\n                        break;\r\n                    }\r\n\r\n                }\r\n            }\r\n        }\r\n        this.border = Matrix;\r\n    }\r\n\r\n    Right()\r\n    {\r\n        let Matrix = this.border;\r\n        for (let i = Matrix.length - 1; i >= 0; i--) {\r\n            // 从上向下遍历\r\n            for (let j = 0; j < Matrix[i].length; j++) {\r\n                for (let k = i - 1; k >= 0; k--) {\r\n                    if (Matrix[k][j] == 0) {\r\n                        continue;\r\n                    }\r\n                    if (Matrix[k][j] != Matrix[i][j]) {\r\n                        if (Matrix[i][j] == 0) {\r\n                            for (let n = k - 1; n >= -1; n--) {\r\n                                // 到达边界\r\n                                if (!Matrix.hasOwnProperty(n)) {\r\n                                    Matrix[i][j] = Matrix[k][j];\r\n                                    Matrix[k][j] = 0;\r\n                                    break;\r\n                                }\r\n                                if (Matrix[n][i] == 0) {\r\n                                    continue;\r\n                                }\r\n                                if (Matrix[n][j] == Matrix[k][j]) {\r\n                                    Matrix[i][j] = Matrix[n][j] * 2;\r\n                                    Matrix[k][j] = 0;\r\n                                    Matrix[n][j] = 0;\r\n                                    break;\r\n                                }\r\n                                if (Matrix.hasOwnProperty(n) && Matrix[n][j] != Matrix[k][j]) {\r\n                                    Matrix[i][j] = Matrix[k][j];\r\n                                    Matrix[k][j] = 0;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    if (Matrix[i][j] == Matrix[k][j]) {\r\n                        Matrix[i][j] += Matrix[k][j];\r\n                        Matrix[k][j] = 0;\r\n                        break;\r\n                    }\r\n\r\n                }\r\n            }\r\n        }\r\n        this.border = Matrix;\r\n    }\r\n\r\n    Win()\r\n    {\r\n        Array.prototype.max = function () \r\n        {\r\n            return Math.max.apply({}, this)\r\n        } \r\n        \r\n        let max = 0;\r\n        this.border.forEach(function (arr, i) {\r\n            if (arr.max() > max) \r\n            {\r\n                max = arr.max();\r\n            }\r\n        });\r\n        if (max >= 2048) \r\n        {\r\n            alert('you wind');\r\n            return;\r\n        }\r\n    }\r\n}\r\n/* harmony default export */ var src_gameController = (gameController);\n// CONCATENATED MODULE: ./src/viewController.js\nclass viewController\r\n{\r\n    constructor(tag,width,num)\r\n    {\r\n        this.context  = tag.getContext('2d');\r\n        this.margin   = 10;\r\n        this.width    = width;\r\n        this.height   = width;\r\n        this.boxWidth = (width - this.margin * (num + 1)) / num;\r\n    }\r\n    \r\n    background(Matrix)\r\n    {\r\n        let positionX = 0;\r\n        let positionY = 0;\r\n        this.context.clearRect(0, 0, this.width, this.width);\r\n        \r\n        for (let i = 0; i < Matrix.length ; i++)\r\n        {\r\n            for (let j = 0; j < Matrix.length; j++) \r\n            {\r\n                positionX = (i + 1) * this.margin + i * this.boxWidth;\r\n                positionY = (j + 1) * this.margin + j * this.boxWidth;\r\n                this.drawBox(positionX, positionY, this.setColor(Matrix[i][j]), Matrix[i][j]);\r\n            }\r\n        }    \r\n    }\r\n\r\n    drawBox(x,y,color=\"#fff\",num)\r\n    {\r\n        let radius = this.boxWidth * 0.07;\r\n        this.context.beginPath();\r\n        this.context.fillStyle = color;\r\n        this.context.moveTo(x, y);\r\n        this.context.arcTo(x + this.boxWidth, y, x + this.boxWidth, y + this.boxWidth, radius);\r\n        this.context.arcTo(x + this.boxWidth, y + this.boxWidth, x, y + this.boxWidth, radius);\r\n        this.context.arcTo(x, y + this.boxWidth, x, y, radius);\r\n        this.context.arcTo(x, y, x + this.boxWidth, y, radius);\r\n        this.context.fill();\r\n        if (num > 0) {\r\n            this.context.fillStyle = \"#fff\";\r\n            this.context.font = \"20px Georgia\";\r\n            this.context.fillText(num, x + this.boxWidth / 2 - 5, y + this.boxWidth / 2 + 5);\r\n        }\r\n        this.context.closePath();\r\n    }\r\n\r\n    setColor(number)\r\n    {\r\n        switch (number) {\r\n            case 2:\r\n                return '#96cccc';\r\n                break;\r\n            case 4:\r\n                return '#60cccc';\r\n                break;\r\n            case 8:\r\n                return '#60fccc';\r\n                break;\r\n            case 16:\r\n                return '#60fc00';\r\n                break;\r\n            case 32:\r\n                return '#fff300';\r\n                break;\r\n            case 64:\r\n                return '#ffab00';\r\n                break;\r\n            case 128:\r\n                return '#ff8100';\r\n                break;\r\n            case 256:\r\n                return '#ff4b00';\r\n                break;\r\n            case 512:\r\n                return '#d51b00';\r\n                break;\r\n            case 1024:\r\n                return '#451b00';\r\n                break;\r\n            case 2048:\r\n                return '#151b00';\r\n                break;\r\n        }\r\n        return \"#fff\";\r\n    }\r\n}\r\n/* harmony default export */ var src_viewController = (viewController);\n// CONCATENATED MODULE: ./src/main.js\n\r\n\r\nlet game = new src_gameController(4);\r\ngame.createNum(2);\r\nlet tag          = document.getElementById('canvas');\r\nlet main_parent       = tag.parentNode;\r\nlet width        = main_parent.clientWidth;\r\nlet height       = main_parent.clientHeight;\r\ntag.width        = width;\r\ntag.height       = height;\r\nlet view  = new src_viewController(tag,width,game.num);\r\nview.background(game.border);\r\n\r\n// 键盘监听\r\ndocument.onkeydown = function (event) \r\n{\r\n    var e   = event || window.event || arguments.callee.caller.arguments[0];\r\n    var key = e.keyCode;\r\n    switch (key)\r\n    {\r\n        // 左\r\n        case 37:\r\n            game.Left();\r\n            reDraw();\r\n            break;\r\n        // 上\r\n        case 38:\r\n            game.Up();\r\n            reDraw();\r\n            break;\r\n        // 右\r\n        case 39:\r\n            game.Right();\r\n            reDraw();\r\n            break;\r\n        // 下\r\n        case 40:\r\n            game.Down();\r\n            reDraw();\r\n            break;\r\n    }\r\n}; \r\n// 监听陀螺仪\r\nif (window.DeviceMotionEvent) {\r\n    window.addEventListener('deviceorientation', deviceMotionHandler, false);\r\n}else{\r\n    alert('当前浏览器不支持 重力感应,抱歉');\r\n}\r\nvar Direction = {\r\n    up:0,\r\n    down:0,\r\n    left:0,\r\n    right:0\r\n};\r\nvar limit = 15;\r\nvar start = {\r\n    x: null,\r\n    y: null,\r\n}\r\nvar lasttime = 0;\r\nfunction deviceMotionHandler(event)\r\n{\r\n    var beta = Math.ceil(event.beta);\r\n    var gamma = Math.ceil(event.gamma);\r\n    // 设置其实位置\r\n    if (start.x == 'null') {\r\n        start.x = beta;\r\n    }\r\n    if (start.y == 'null') \r\n    {\r\n        start.y = gamma;\r\n    }\r\n    if (new Date().getTime() < lasttime) \r\n    {\r\n        return;\r\n    }\r\n    if (Math.abs(beta)-start.x > Math.abs(gamma)-start.y) \r\n    {\r\n        // 误差数量\r\n        if (beta < start.x - limit) {\r\n\r\n            if (Math.abs(Direction.up) - limit < Math.abs(beta) && Math.abs(beta) < Math.abs(Direction.up) + limit) {\r\n                return;\r\n            }\r\n            lasttime = new Date().getTime() + 1000;\r\n            Direction.up = beta;\r\n            game.Up();\r\n            reDraw();\r\n\r\n        } else if (beta > start.x + limit) {\r\n            if (Math.abs(Direction.down) - limit < Math.abs(beta) && Math.abs(beta) < Math.abs(Direction.down) + limit) {\r\n                return;\r\n            }\r\n            lasttime = new Date().getTime() + 1000;\r\n            Direction.down = beta;\r\n            game.Down();\r\n            reDraw();\r\n        }\r\n        \r\n    }else{\r\n        // 误差数量\r\n        if (gamma < start.y - limit) {\r\n\r\n            if (Math.abs(Direction.left) - limit < Math.abs(gamma) && Math.abs(gamma) < Math.abs(Direction.left) + limit) {\r\n                return;\r\n            }\r\n\r\n            lasttime = new Date().getTime() + 1000;\r\n            Direction.left = gamma;\r\n            game.Left();\r\n            reDraw();\r\n\r\n        } else if (gamma > start.y + limit) {\r\n            if (Math.abs(Direction.right) - limit < Math.abs(gamma) && Math.abs(gamma) < Math.abs(Direction.right) + limit) {\r\n                return;\r\n            }\r\n            lasttime = new Date().getTime() + 1000;\r\n            Direction.right = gamma;\r\n            game.Right();\r\n            reDraw();\r\n        }\r\n    }\r\n    \r\n\r\n\r\n    // if (beta < 0 && Math.abs(beta) - Math.abs(Direction.up) >= limit ) \r\n    // {\r\n    //     game.Up();\r\n    //     reDraw();\r\n    //     Direction.up   = beta;\r\n    //     Direction.down = 0;\r\n    // } else if (beta > 0 && beta - Direction.down >=limit)\r\n    // {\r\n    //     game.Down();\r\n    //     reDraw();\r\n    //     Direction.down = beta;\r\n    //     Direction.up = 0;\r\n    // }\r\n    // if (gamma < 0 && Math.abs(gamma) - Math.abs(Direction.left) >= limit) {\r\n    //     game.Left();\r\n    //     reDraw();\r\n    //     Direction.left = gamma;\r\n    //     Direction.right = 0;\r\n    // } else if (gamma > 0 && gamma - Direction.right >= limit) {\r\n    //     game.Right();\r\n    //     reDraw();\r\n    //     Direction.right = gamma;\r\n    //     Direction.letf = 0;\r\n    // }\r\n}\r\n\r\nfunction reDraw()\r\n{\r\n    game.createNum(1);\r\n    view.background(game.border);\r\n}\r\n\r\nfunction sleep(numberMillis) \r\n{\r\n    var now = new Date();\r\n    var exitTime = now.getTime() + numberMillis;\r\n    while (true) {\r\n        now = new Date();\r\n        if (now.getTime() > exitTime)\r\n            return;\r\n    } \r\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZUNvbnRyb2xsZXIuanM/OWI2YyIsIndlYnBhY2s6Ly8vLi9zcmMvdmlld0NvbnRyb2xsZXIuanM/YjkwOSIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi5qcz81NmQ3Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxJQUFJO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxJQUFJO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLFNBQVM7QUFDaEM7QUFDQTtBQUNBLDJCQUEyQixTQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixXQUFXO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLHlEO0FBQ0E7QUFDQTtBQUNBLHlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7OztBQUdBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixtQkFBbUI7QUFDMUM7QUFDQSw4Q0FBOEMsUUFBUTtBQUN0RCxtQ0FBbUMsUUFBUTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFNBQVM7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7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O0FBQ0EsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLO0FBQ0EiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIGdhbWVDb250cm9sbGVyXHJcbntcclxuICAgIC8qKlxyXG4gICAgICog5p6E6YCg5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0ge2ludH0gbnVtIOWkp+Wwj1xyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihudW0pXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5udW0gICAgPSBudW07XHJcbiAgICAgICAgdGhpcy5ib3JkZXIgPSB0aGlzLmluaXQobnVtKTtcclxuICAgICAgICAvLyB0aGlzLmJvcmRlciA9IGJvcmRlcjtcclxuICAgICAgICAvLyB0aGlzLndpZHRoICA9IHdpZHRoO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDliJ3lp4vljJbmlbDmja7nn6npmLUo5LqM57u05pWw57uEKVxyXG4gICAgICogQHBhcmFtIHtpbnR9IG51bSDliJ3lp4vljJZcclxuICAgICAqL1xyXG4gICAgaW5pdChudW0pXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IGJvcmRlciA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtOyBpKyspXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBib3JkZXJbaV0gID0gW107XHJcbiAgICAgICAgICAgIGZvcihsZXQgaiA9IDAgOyBqIDxudW0gOyBqKyspXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJvcmRlcltpXVtqXSAgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBib3JkZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpmo/mnLrnlJ/miJB0aW1lc+S4quaVsOWtl1xyXG4gICAgICogQHBhcmFtIGluc3QgdGltZXMg55Sf5oiQ5Liq5pWwXHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZU51bSh0aW1lcylcclxuICAgIHtcclxuICAgICAgICAvLyDmo4Dmn6XmmK/lkKbov5jmnInnqbrkvZnnmoTmoLzlrZBcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbWVzOyBpKyspIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmNoZWNrU3BhY2UoKSkgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIC8vIGxldCByYW5kWSA9IDA7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOmaj+acunjkvY3nva5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZFggPSBwYXJzZUludChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLm51bSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGxldCByYW5kWCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6ZqP5py6eeS9jee9rlxyXG4gICAgICAgICAgICAgICAgICAgIGxldCByYW5kWSA9IHBhcnNlSW50KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMubnVtKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u6ZqP5py65YC8XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYm9yZGVyW3JhbmRYXVtyYW5kWV0gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJvcmRlcltyYW5kWF1bcmFuZFldID0gTWF0aC5yYW5kb20oKSA8IC41ID8gMiA6IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyByYW5kWSA9IDI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IGNvbmZpcm0oXCLmuLjmiI/nu5PmnZ9cIilcclxuICAgICAgICAgICAgICAgIGlmIChyID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGxvY2F0aW9uLmhyZWY7ICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGxvY2F0aW9uLmhyZWY7ICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOajgOafpeaYr+WQpui/mOacieepuuS9meepuumXtFxyXG4gICAgICovXHJcbiAgICBjaGVja1NwYWNlKClcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXIuZXZlcnkoZnVuY3Rpb24gKGlhcnIsIGkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlhcnIuZXZlcnkoZnVuY3Rpb24gKG51bSwgaikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbiAgICBEb3duKClcclxuICAgIHtcclxuICAgICAgICBsZXQgTWF0cml4ID0gdGhpcy5ib3JkZXI7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRyaXgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgLy8g5LuO5LiK5ZCR5LiL6YGN5Y6GKOaOkumZpOesrOS4gOS9jSlcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IE1hdHJpeFtpXS5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IGogLSAxOyBrID49IDA7IGstLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbaV1ba10gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdHJpeFtpXVtrXSAhPSBNYXRyaXhbaV1bal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdHJpeFtpXVtqXSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBuID0gayAtIDE7IG4gPj0gLTE7IG4tLSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWIsOi+vui+ueeVjFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghTWF0cml4W2ldLmhhc093blByb3BlcnR5KG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtqXSA9IE1hdHJpeFtpXVtrXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2ldW2tdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbaV1bbl0gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdHJpeFtpXVtuXSA9PSBNYXRyaXhbaV1ba10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2ldW2pdID0gTWF0cml4W2ldW25dICogMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2ldW2tdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2ldW25dID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbaV0uaGFzT3duUHJvcGVydHkobikgJiYgTWF0cml4W2ldW25dICE9IE1hdHJpeFtpXVtrXSAmJiBNYXRyaXhbaV1bal0gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRyaXhbaV1bal0gPSBNYXRyaXhbaV1ba107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtrXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbaV1ba10gPT0gTWF0cml4W2ldW2pdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtqXSArPSBNYXRyaXhbaV1ba107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtrXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmJvcmRlciA9IE1hdHJpeDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgVXAoKVxyXG4gICAge1xyXG4gICAgICAgIGxldCBNYXRyaXggPSB0aGlzLmJvcmRlcjtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1hdHJpeC5sZW5ndGg7IGkrKykgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvLyDku47kuIrlkJHkuIvpgY3ljoZcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBNYXRyaXhbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSBqICsgMTsgayA8IE1hdHJpeFtpXS5sZW5ndGg7IGsrKykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoTWF0cml4W2ldW2tdID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbaV1ba10gIT0gTWF0cml4W2ldW2pdKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0cml4W2ldW2pdID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG4gPSBrICsgMTsgbiA8PSBNYXRyaXhbaV0ubGVuZ3RoOyBuKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDliLDovr7ovrnnlYxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIU1hdHJpeFtpXS5oYXNPd25Qcm9wZXJ0eShuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRyaXhbaV1bal0gPSBNYXRyaXhbaV1ba107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtrXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0cml4W2ldW25dID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbaV1bbl0gPT0gTWF0cml4W2ldW2tdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtqXSA9IE1hdHJpeFtpXVtuXSAqIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtrXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtuXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0cml4W2ldLmhhc093blByb3BlcnR5KG4pICYmIE1hdHJpeFtpXVtuXSAhPSBNYXRyaXhbaV1ba10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2ldW2pdID0gTWF0cml4W2ldW2tdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRyaXhbaV1ba10gPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbaV1bal0gPT0gTWF0cml4W2ldW2tdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtqXSArPSBNYXRyaXhbaV1ba107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtrXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ib3JkZXIgPSBNYXRyaXg7XHJcbiAgICB9XHJcblxyXG4gICAgTGVmdCgpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IE1hdHJpeCA9IHRoaXMuYm9yZGVyO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0cml4Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIOS7juS4iuWQkeS4i+mBjeWOhlxyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IE1hdHJpeFtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IGkgKyAxOyBrIDwgTWF0cml4Lmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdHJpeFtrXVtqXSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoTWF0cml4W2tdW2pdICE9IE1hdHJpeFtpXVtqXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0cml4W2ldW2pdID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG4gPSBrICsgMTsgbiA8PSBNYXRyaXgubGVuZ3RoOyBuKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDliLDovr7ovrnnlYxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIU1hdHJpeC5oYXNPd25Qcm9wZXJ0eShuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRyaXhbaV1bal0gPSBNYXRyaXhba11bal07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtrXVtqXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0cml4W25dW2ldID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbbl1bal0gPT0gTWF0cml4W2tdW2pdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtqXSA9IE1hdHJpeFtuXVtqXSAqIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtrXVtqXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtuXVtqXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0cml4Lmhhc093blByb3BlcnR5KG4pICYmIE1hdHJpeFtuXVtqXSAhPSBNYXRyaXhba11bal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2ldW2pdID0gTWF0cml4W2tdW2pdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRyaXhba11bal0gPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbaV1bal0gPT0gTWF0cml4W2tdW2pdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtqXSArPSBNYXRyaXhba11bal07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtrXVtqXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ib3JkZXIgPSBNYXRyaXg7XHJcbiAgICB9XHJcblxyXG4gICAgUmlnaHQoKVxyXG4gICAge1xyXG4gICAgICAgIGxldCBNYXRyaXggPSB0aGlzLmJvcmRlcjtcclxuICAgICAgICBmb3IgKGxldCBpID0gTWF0cml4Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgIC8vIOS7juS4iuWQkeS4i+mBjeWOhlxyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IE1hdHJpeFtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IGkgLSAxOyBrID49IDA7IGstLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhba11bal0gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdHJpeFtrXVtqXSAhPSBNYXRyaXhbaV1bal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdHJpeFtpXVtqXSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBuID0gayAtIDE7IG4gPj0gLTE7IG4tLSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWIsOi+vui+ueeVjFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghTWF0cml4Lmhhc093blByb3BlcnR5KG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtpXVtqXSA9IE1hdHJpeFtrXVtqXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2tdW2pdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXhbbl1baV0gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdHJpeFtuXVtqXSA9PSBNYXRyaXhba11bal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2ldW2pdID0gTWF0cml4W25dW2pdICogMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2tdW2pdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W25dW2pdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRyaXguaGFzT3duUHJvcGVydHkobikgJiYgTWF0cml4W25dW2pdICE9IE1hdHJpeFtrXVtqXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRyaXhbaV1bal0gPSBNYXRyaXhba11bal07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdHJpeFtrXVtqXSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdHJpeFtpXVtqXSA9PSBNYXRyaXhba11bal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2ldW2pdICs9IE1hdHJpeFtrXVtqXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0cml4W2tdW2pdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmJvcmRlciA9IE1hdHJpeDtcclxuICAgIH1cclxuXHJcbiAgICBXaW4oKVxyXG4gICAge1xyXG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5tYXggPSBmdW5jdGlvbiAoKSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1heC5hcHBseSh7fSwgdGhpcylcclxuICAgICAgICB9IFxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBtYXggPSAwO1xyXG4gICAgICAgIHRoaXMuYm9yZGVyLmZvckVhY2goZnVuY3Rpb24gKGFyciwgaSkge1xyXG4gICAgICAgICAgICBpZiAoYXJyLm1heCgpID4gbWF4KSBcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbWF4ID0gYXJyLm1heCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKG1heCA+PSAyMDQ4KSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGFsZXJ0KCd5b3Ugd2luZCcpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IGdhbWVDb250cm9sbGVyIiwiY2xhc3Mgdmlld0NvbnRyb2xsZXJcclxue1xyXG4gICAgY29uc3RydWN0b3IodGFnLHdpZHRoLG51bSlcclxuICAgIHtcclxuICAgICAgICB0aGlzLmNvbnRleHQgID0gdGFnLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgdGhpcy5tYXJnaW4gICA9IDEwO1xyXG4gICAgICAgIHRoaXMud2lkdGggICAgPSB3aWR0aDtcclxuICAgICAgICB0aGlzLmhlaWdodCAgID0gd2lkdGg7XHJcbiAgICAgICAgdGhpcy5ib3hXaWR0aCA9ICh3aWR0aCAtIHRoaXMubWFyZ2luICogKG51bSArIDEpKSAvIG51bTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYmFja2dyb3VuZChNYXRyaXgpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHBvc2l0aW9uWCA9IDA7XHJcbiAgICAgICAgbGV0IHBvc2l0aW9uWSA9IDA7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LmNsZWFyUmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLndpZHRoKTtcclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1hdHJpeC5sZW5ndGggOyBpKyspXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IE1hdHJpeC5sZW5ndGg7IGorKykgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IChpICsgMSkgKiB0aGlzLm1hcmdpbiArIGkgKiB0aGlzLmJveFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gKGogKyAxKSAqIHRoaXMubWFyZ2luICsgaiAqIHRoaXMuYm94V2lkdGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdCb3gocG9zaXRpb25YLCBwb3NpdGlvblksIHRoaXMuc2V0Q29sb3IoTWF0cml4W2ldW2pdKSwgTWF0cml4W2ldW2pdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gICAgXHJcbiAgICB9XHJcblxyXG4gICAgZHJhd0JveCh4LHksY29sb3I9XCIjZmZmXCIsbnVtKVxyXG4gICAge1xyXG4gICAgICAgIGxldCByYWRpdXMgPSB0aGlzLmJveFdpZHRoICogMC4wNztcclxuICAgICAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9IGNvbG9yO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5tb3ZlVG8oeCwgeSk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LmFyY1RvKHggKyB0aGlzLmJveFdpZHRoLCB5LCB4ICsgdGhpcy5ib3hXaWR0aCwgeSArIHRoaXMuYm94V2lkdGgsIHJhZGl1cyk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LmFyY1RvKHggKyB0aGlzLmJveFdpZHRoLCB5ICsgdGhpcy5ib3hXaWR0aCwgeCwgeSArIHRoaXMuYm94V2lkdGgsIHJhZGl1cyk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LmFyY1RvKHgsIHkgKyB0aGlzLmJveFdpZHRoLCB4LCB5LCByYWRpdXMpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5hcmNUbyh4LCB5LCB4ICsgdGhpcy5ib3hXaWR0aCwgeSwgcmFkaXVzKTtcclxuICAgICAgICB0aGlzLmNvbnRleHQuZmlsbCgpO1xyXG4gICAgICAgIGlmIChudW0gPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSBcIiNmZmZcIjtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmZvbnQgPSBcIjIwcHggR2VvcmdpYVwiO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuZmlsbFRleHQobnVtLCB4ICsgdGhpcy5ib3hXaWR0aCAvIDIgLSA1LCB5ICsgdGhpcy5ib3hXaWR0aCAvIDIgKyA1KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldENvbG9yKG51bWJlcilcclxuICAgIHtcclxuICAgICAgICBzd2l0Y2ggKG51bWJlcikge1xyXG4gICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyM5NmNjY2MnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnIzYwY2NjYyc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA4OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcjNjBmY2NjJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE2OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcjNjBmYzAwJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDMyOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcjZmZmMzAwJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDY0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcjZmZhYjAwJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDEyODpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnI2ZmODEwMCc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyNTY6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyNmZjRiMDAnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNTEyOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcjZDUxYjAwJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDEwMjQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyM0NTFiMDAnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjA0ODpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnIzE1MWIwMCc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFwiI2ZmZlwiO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IHZpZXdDb250cm9sbGVyIiwiaW1wb3J0IGdhbWVDb250cm9sbGVyIGZyb20gXCIuL2dhbWVDb250cm9sbGVyXCI7XHJcbmltcG9ydCB2aWV3Q29udHJvbGxlciBmcm9tIFwiLi92aWV3Q29udHJvbGxlclwiO1xyXG5sZXQgZ2FtZSA9IG5ldyBnYW1lQ29udHJvbGxlcig0KTtcclxuZ2FtZS5jcmVhdGVOdW0oMik7XHJcbmxldCB0YWcgICAgICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XHJcbmxldCBwYXJlbnQgICAgICAgPSB0YWcucGFyZW50Tm9kZTtcclxubGV0IHdpZHRoICAgICAgICA9IHBhcmVudC5jbGllbnRXaWR0aDtcclxubGV0IGhlaWdodCAgICAgICA9IHBhcmVudC5jbGllbnRIZWlnaHQ7XHJcbnRhZy53aWR0aCAgICAgICAgPSB3aWR0aDtcclxudGFnLmhlaWdodCAgICAgICA9IGhlaWdodDtcclxubGV0IHZpZXcgID0gbmV3IHZpZXdDb250cm9sbGVyKHRhZyx3aWR0aCxnYW1lLm51bSk7XHJcbnZpZXcuYmFja2dyb3VuZChnYW1lLmJvcmRlcik7XHJcblxyXG4vLyDplK7nm5jnm5HlkKxcclxuZG9jdW1lbnQub25rZXlkb3duID0gZnVuY3Rpb24gKGV2ZW50KSBcclxue1xyXG4gICAgdmFyIGUgICA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudCB8fCBhcmd1bWVudHMuY2FsbGVlLmNhbGxlci5hcmd1bWVudHNbMF07XHJcbiAgICB2YXIga2V5ID0gZS5rZXlDb2RlO1xyXG4gICAgc3dpdGNoIChrZXkpXHJcbiAgICB7XHJcbiAgICAgICAgLy8g5bemXHJcbiAgICAgICAgY2FzZSAzNzpcclxuICAgICAgICAgICAgZ2FtZS5MZWZ0KCk7XHJcbiAgICAgICAgICAgIHJlRHJhdygpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAvLyDkuIpcclxuICAgICAgICBjYXNlIDM4OlxyXG4gICAgICAgICAgICBnYW1lLlVwKCk7XHJcbiAgICAgICAgICAgIHJlRHJhdygpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAvLyDlj7NcclxuICAgICAgICBjYXNlIDM5OlxyXG4gICAgICAgICAgICBnYW1lLlJpZ2h0KCk7XHJcbiAgICAgICAgICAgIHJlRHJhdygpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAvLyDkuItcclxuICAgICAgICBjYXNlIDQwOlxyXG4gICAgICAgICAgICBnYW1lLkRvd24oKTtcclxuICAgICAgICAgICAgcmVEcmF3KCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59OyBcclxuLy8g55uR5ZCs6ZmA6J665LuqXHJcbmlmICh3aW5kb3cuRGV2aWNlTW90aW9uRXZlbnQpIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkZXZpY2VvcmllbnRhdGlvbicsIGRldmljZU1vdGlvbkhhbmRsZXIsIGZhbHNlKTtcclxufWVsc2V7XHJcbiAgICBhbGVydCgn5b2T5YmN5rWP6KeI5Zmo5LiN5pSv5oyBIOmHjeWKm+aEn+W6lCzmirHmrYknKTtcclxufVxyXG52YXIgRGlyZWN0aW9uID0ge1xyXG4gICAgdXA6MCxcclxuICAgIGRvd246MCxcclxuICAgIGxlZnQ6MCxcclxuICAgIHJpZ2h0OjBcclxufTtcclxudmFyIGxpbWl0ID0gMTU7XHJcbnZhciBzdGFydCA9IHtcclxuICAgIHg6IG51bGwsXHJcbiAgICB5OiBudWxsLFxyXG59XHJcbnZhciBsYXN0dGltZSA9IDA7XHJcbmZ1bmN0aW9uIGRldmljZU1vdGlvbkhhbmRsZXIoZXZlbnQpXHJcbntcclxuICAgIHZhciBiZXRhID0gTWF0aC5jZWlsKGV2ZW50LmJldGEpO1xyXG4gICAgdmFyIGdhbW1hID0gTWF0aC5jZWlsKGV2ZW50LmdhbW1hKTtcclxuICAgIC8vIOiuvue9ruWFtuWunuS9jee9rlxyXG4gICAgaWYgKHN0YXJ0LnggPT0gJ251bGwnKSB7XHJcbiAgICAgICAgc3RhcnQueCA9IGJldGE7XHJcbiAgICB9XHJcbiAgICBpZiAoc3RhcnQueSA9PSAnbnVsbCcpIFxyXG4gICAge1xyXG4gICAgICAgIHN0YXJ0LnkgPSBnYW1tYTtcclxuICAgIH1cclxuICAgIGlmIChuZXcgRGF0ZSgpLmdldFRpbWUoKSA8IGxhc3R0aW1lKSBcclxuICAgIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoTWF0aC5hYnMoYmV0YSktc3RhcnQueCA+IE1hdGguYWJzKGdhbW1hKS1zdGFydC55KSBcclxuICAgIHtcclxuICAgICAgICAvLyDor6/lt67mlbDph49cclxuICAgICAgICBpZiAoYmV0YSA8IHN0YXJ0LnggLSBsaW1pdCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKE1hdGguYWJzKERpcmVjdGlvbi51cCkgLSBsaW1pdCA8IE1hdGguYWJzKGJldGEpICYmIE1hdGguYWJzKGJldGEpIDwgTWF0aC5hYnMoRGlyZWN0aW9uLnVwKSArIGxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGFzdHRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIDEwMDA7XHJcbiAgICAgICAgICAgIERpcmVjdGlvbi51cCA9IGJldGE7XHJcbiAgICAgICAgICAgIGdhbWUuVXAoKTtcclxuICAgICAgICAgICAgcmVEcmF3KCk7XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoYmV0YSA+IHN0YXJ0LnggKyBsaW1pdCkge1xyXG4gICAgICAgICAgICBpZiAoTWF0aC5hYnMoRGlyZWN0aW9uLmRvd24pIC0gbGltaXQgPCBNYXRoLmFicyhiZXRhKSAmJiBNYXRoLmFicyhiZXRhKSA8IE1hdGguYWJzKERpcmVjdGlvbi5kb3duKSArIGxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGFzdHRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIDEwMDA7XHJcbiAgICAgICAgICAgIERpcmVjdGlvbi5kb3duID0gYmV0YTtcclxuICAgICAgICAgICAgZ2FtZS5Eb3duKCk7XHJcbiAgICAgICAgICAgIHJlRHJhdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1lbHNle1xyXG4gICAgICAgIC8vIOivr+W3ruaVsOmHj1xyXG4gICAgICAgIGlmIChnYW1tYSA8IHN0YXJ0LnkgLSBsaW1pdCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKE1hdGguYWJzKERpcmVjdGlvbi5sZWZ0KSAtIGxpbWl0IDwgTWF0aC5hYnMoZ2FtbWEpICYmIE1hdGguYWJzKGdhbW1hKSA8IE1hdGguYWJzKERpcmVjdGlvbi5sZWZ0KSArIGxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxhc3R0aW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgKyAxMDAwO1xyXG4gICAgICAgICAgICBEaXJlY3Rpb24ubGVmdCA9IGdhbW1hO1xyXG4gICAgICAgICAgICBnYW1lLkxlZnQoKTtcclxuICAgICAgICAgICAgcmVEcmF3KCk7XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoZ2FtbWEgPiBzdGFydC55ICsgbGltaXQpIHtcclxuICAgICAgICAgICAgaWYgKE1hdGguYWJzKERpcmVjdGlvbi5yaWdodCkgLSBsaW1pdCA8IE1hdGguYWJzKGdhbW1hKSAmJiBNYXRoLmFicyhnYW1tYSkgPCBNYXRoLmFicyhEaXJlY3Rpb24ucmlnaHQpICsgbGltaXQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsYXN0dGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgMTAwMDtcclxuICAgICAgICAgICAgRGlyZWN0aW9uLnJpZ2h0ID0gZ2FtbWE7XHJcbiAgICAgICAgICAgIGdhbWUuUmlnaHQoKTtcclxuICAgICAgICAgICAgcmVEcmF3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcblxyXG5cclxuICAgIC8vIGlmIChiZXRhIDwgMCAmJiBNYXRoLmFicyhiZXRhKSAtIE1hdGguYWJzKERpcmVjdGlvbi51cCkgPj0gbGltaXQgKSBcclxuICAgIC8vIHtcclxuICAgIC8vICAgICBnYW1lLlVwKCk7XHJcbiAgICAvLyAgICAgcmVEcmF3KCk7XHJcbiAgICAvLyAgICAgRGlyZWN0aW9uLnVwICAgPSBiZXRhO1xyXG4gICAgLy8gICAgIERpcmVjdGlvbi5kb3duID0gMDtcclxuICAgIC8vIH0gZWxzZSBpZiAoYmV0YSA+IDAgJiYgYmV0YSAtIERpcmVjdGlvbi5kb3duID49bGltaXQpXHJcbiAgICAvLyB7XHJcbiAgICAvLyAgICAgZ2FtZS5Eb3duKCk7XHJcbiAgICAvLyAgICAgcmVEcmF3KCk7XHJcbiAgICAvLyAgICAgRGlyZWN0aW9uLmRvd24gPSBiZXRhO1xyXG4gICAgLy8gICAgIERpcmVjdGlvbi51cCA9IDA7XHJcbiAgICAvLyB9XHJcbiAgICAvLyBpZiAoZ2FtbWEgPCAwICYmIE1hdGguYWJzKGdhbW1hKSAtIE1hdGguYWJzKERpcmVjdGlvbi5sZWZ0KSA+PSBsaW1pdCkge1xyXG4gICAgLy8gICAgIGdhbWUuTGVmdCgpO1xyXG4gICAgLy8gICAgIHJlRHJhdygpO1xyXG4gICAgLy8gICAgIERpcmVjdGlvbi5sZWZ0ID0gZ2FtbWE7XHJcbiAgICAvLyAgICAgRGlyZWN0aW9uLnJpZ2h0ID0gMDtcclxuICAgIC8vIH0gZWxzZSBpZiAoZ2FtbWEgPiAwICYmIGdhbW1hIC0gRGlyZWN0aW9uLnJpZ2h0ID49IGxpbWl0KSB7XHJcbiAgICAvLyAgICAgZ2FtZS5SaWdodCgpO1xyXG4gICAgLy8gICAgIHJlRHJhdygpO1xyXG4gICAgLy8gICAgIERpcmVjdGlvbi5yaWdodCA9IGdhbW1hO1xyXG4gICAgLy8gICAgIERpcmVjdGlvbi5sZXRmID0gMDtcclxuICAgIC8vIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcmVEcmF3KClcclxue1xyXG4gICAgZ2FtZS5jcmVhdGVOdW0oMSk7XHJcbiAgICB2aWV3LmJhY2tncm91bmQoZ2FtZS5ib3JkZXIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzbGVlcChudW1iZXJNaWxsaXMpIFxyXG57XHJcbiAgICB2YXIgbm93ID0gbmV3IERhdGUoKTtcclxuICAgIHZhciBleGl0VGltZSA9IG5vdy5nZXRUaW1lKCkgKyBudW1iZXJNaWxsaXM7XHJcbiAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgIG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgaWYgKG5vdy5nZXRUaW1lKCkgPiBleGl0VGltZSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgfSBcclxufSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///0\n")}]);